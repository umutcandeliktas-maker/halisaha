<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Taktik Pro v10.7 - True Random</title>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .field-container { position: relative; margin: 20px auto; width: fit-content; }
    .field {
      position: relative; width: 1100px; height: 650px; background-color: #12632b;
      border: 5px solid white; border-radius: 15px; overflow: hidden;
      box-shadow: 0 25px 50px rgba(0,0,0,0.8);
    }
    .line { position: absolute; background: rgba(255,255,255,0.7); }
    .center-line { top: 0; left: 50%; width: 2px; height: 100%; transform: translateX(-50%); }
    .center-circle { top: 50%; left: 50%; width: 140px; height: 140px; border: 2px solid white; border-radius: 50%; transform: translate(-50%, -50%); }
    .goal-post { position: absolute; top: 50%; transform: translateY(-50%); width: 45px; height: 180px; border: 4px solid white; background: rgba(255,255,255,0.1); }
    .goal-l { left: -5px; border-left: none; }
    .goal-r { right: -5px; border-right: none; }
    .pen-box { position: absolute; border: 2px solid white; top: 50%; transform: translateY(-50%); height: 380px; width: 160px; }
    
    .player {
      position: absolute; width: 115px; padding: 10px 5px; border-radius: 20px;
      font-weight: bold; color: black; cursor: grab; z-index: 10; text-align: center;
      border: 2px solid rgba(0,0,0,0.3); user-select: none; font-size: 13px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.4); transform: translate(-50%, -50%);
      transition: background-color 0.4s, left 0.6s cubic-bezier(0.23, 1, 0.32, 1), top 0.6s cubic-bezier(0.23, 1, 0.32, 1);
    }
    .player .q-tag { font-size: 10px; opacity: 0.9; display: block; }
    .player.selected { outline: 4px solid white; z-index: 100; transition: none !important; }
    .ball {
      position: absolute; width: 40px; height: 40px; background: white; border-radius: 50%;
      display: flex; align-items: center; justify-content: center; z-index: 60;
      box-shadow: 0 4px 15px rgba(0,0,0,0.6); cursor: grab; transform: translate(-50%, -50%);
      font-size: 24px;
    }
  </style>
</head>
<body class="bg-slate-900 text-white font-sans">

<header class="bg-slate-800 text-center py-5 border-b-4 border-green-600 shadow-xl">
  <h1 class="text-3xl font-black italic tracking-tighter uppercase">‚öΩ TAKTƒ∞K PRO v10.7 TRUE RANDOM</h1>
</header>

<div class="container mx-auto p-4">
  <div class="bg-slate-800 p-6 rounded-2xl mb-8 flex flex-wrap gap-4 items-center justify-between border border-slate-700">
    <div class="flex items-center gap-3">
      <div class="flex flex-col">
        <label class="text-[10px] text-slate-400 font-bold ml-1 uppercase">Ki≈üi Sayƒ±sƒ±</label>
        <select id="pCount" class="bg-slate-700 p-3 rounded-xl border border-slate-600 font-bold text-green-400 w-32">
          <option value="12">12 Ki≈üi</option>
          <option value="14" selected>14 Ki≈üi</option>
          <option value="16">16 Ki≈üi</option>
        </select>
      </div>
      <button onclick="generateRandomSquad()" class="mt-4 bg-indigo-600 px-6 py-3 rounded-xl font-bold hover:bg-indigo-500 shadow-lg active:scale-95 transition-all">üé≤ HER SEFERƒ∞NDE FARKLI KUR</button>
      <button onclick="drawTactics()" class="mt-4 bg-yellow-500 text-black px-8 py-3 rounded-xl font-black hover:bg-yellow-400 shadow-lg active:scale-95 transition-all">üèüÔ∏è SAHAYA OTURT</button>
    </div>
    
    <div class="flex gap-3">
      <button onclick="saveField()" class="bg-green-600 px-8 py-3 rounded-full font-bold hover:bg-green-500 shadow-lg">üì∏ KAYDET</button>
      <button onclick="resetApp()" class="bg-red-600/20 text-red-500 px-5 py-3 rounded-xl font-bold hover:bg-red-600 transition-all">SIFIRLA</button>
    </div>
  </div>

  <div id="playerList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-10"></div>

  <div class="field-container mx-auto">
    <div id="field" class="field mx-auto">
      <div class="line center-line"></div>
      <div class="center-circle"></div>
      <div class="goal-post goal-l"></div>
      <div class="goal-post goal-r"></div>
      <div class="pen-box" style="left:0; border-left:none;"></div>
      <div class="pen-box" style="right:0; border-right:none;"></div>
      <div id="ball" class="ball" style="left: 50%; top: 50%;">‚öΩ</div>
    </div>
  </div>
</div>

<script>
let squad = [];
const KEY = 'taktik_pro_v10_7';
const COLORS = { A: '#f3a616', B: '#43d1f0' };
const NAMES = ["Ahmet", "Mehmet", "Can", "Mert", "Ali", "Veli", "Burak", "Serkan", "Emre", "Arda", "Ozan", "Deniz", "Ege", "Kaan", "Yiƒüit", "Sarp", "Bora", "Umut"];

const layoutA = { GK: [{x:8,y:50}], DEF: [{x:22,y:50},{x:24,y:22},{x:24,y:78}], MID: [{x:37,y:35},{x:37,y:65}], FWD: [{x:47,y:50}] };
const layoutB = { GK: [{x:92,y:50}], DEF: [{x:78,y:25},{x:78,y:75}], MID: [{x:66,y:30},{x:66,y:50},{x:66,y:70}], FWD: [{x:56,y:50}] };

function generateRandomSquad() {
  const n = Number(document.getElementById('pCount').value);
  const shuffledNames = [...NAMES].sort(() => Math.random() - 0.5);
  
  // √ñnce oyuncu havuzunu olu≈ütur
  let newSquad = Array.from({length: n}, (_, i) => ({
    id: i,
    name: shuffledNames[i] || `Oyuncu ${i+1}`,
    quality: Math.floor(Math.random() * 5) + 5, // 5-10 arasƒ± kalite
    team: '',
    role: ''
  }));

  // Takƒ±mlarƒ± rastgele karƒ±≈ütƒ±rarak daƒüƒ±t
  let indices = Array.from({length: n}, (_, i) => i).sort(() => Math.random() - 0.5);
  indices.forEach((idx, order) => {
    const isTeamA = order < n/2;
    newSquad[idx].team = isTeamA ? 'A' : 'B';
    const tOrder = isTeamA ? order : order - (n/2);
    
    // Pozisyonlarƒ± mantƒ±klƒ± daƒüƒ±t
    if(tOrder === 0) newSquad[idx].role = 'GK';
    else if(tOrder <= 3) newSquad[idx].role = 'DEF';
    else if(tOrder <= 5) newSquad[idx].role = 'MID';
    else newSquad[idx].role = 'FWD';
  });

  squad = newSquad;
  save(); renderList(); drawTactics();
}

function renderList() {
  const container = document.getElementById('playerList');
  container.innerHTML = squad.map((p, i) => `
    <div class="bg-slate-800 p-3 rounded-xl border-l-4 ${p.team==='A'?'border-orange-500':'border-cyan-500'} shadow-md">
      <div class="flex justify-between items-center mb-1">
        <span class="font-bold">${p.name}</span>
        <span class="text-yellow-500 text-xs">‚≠ê${p.quality}</span>
      </div>
      <div class="text-[10px] text-slate-400 uppercase font-black">${p.role} | Takƒ±m ${p.team}</div>
    </div>
  `).join('');
}

function drawTactics() {
  const f = document.getElementById('field');
  f.querySelectorAll('.player').forEach(p => p.remove());
  
  const teams = { A: squad.filter(p => p.team === 'A'), B: squad.filter(p => p.team === 'B') };

  const place = (teamPlayers, config, teamKey) => {
    let counts = { GK:0, DEF:0, MID:0, FWD:0 };
    teamPlayers.forEach((p) => {
      const el = document.createElement('div');
      el.className = 'player';
      el.style.backgroundColor = COLORS[p.team];
      el.innerHTML = `<div>${p.name}</div><span class="q-tag">‚≠ê${p.quality} - ${p.role}</span>`;
      
      let posSet = config[p.role] || [{x:50,y:50}];
      let pos = posSet[counts[p.role] % posSet.length];
      
      el.style.left = (pos.x * 11) + "px";
      el.style.top = (pos.y * 6.5) + "px";
      
      // √áift Tƒ±k Renk Deƒüi≈üimi
      el.ondblclick = () => {
        p.team = p.team === 'A' ? 'B' : 'A';
        el.style.backgroundColor = COLORS[p.team];
        save(); renderList();
      };
      
      counts[p.role]++;
      drag(el);
      f.appendChild(el);
    });
  };

  place(teams.A, layoutA, 'A');
  place(teams.B, layoutB, 'B');
}

function drag(el) {
  let active = false, startX, startY, initX, initY;
  const evStart = (e) => {
    active = true;
    const c = e.touches ? e.touches[0] : e;
    startX = c.clientX; startY = c.clientY;
    initX = el.offsetLeft; initY = el.offsetTop;
    el.style.transition = 'none';
  };
  const evMove = (e) => {
    if (!active) return;
    const c = e.touches ? e.touches[0] : e;
    el.style.left = (initX + (c.clientX - startX)) + "px";
    el.style.top = (initY + (c.clientY - startY)) + "px";
  };
  const evEnd = () => {
    active = false;
    el.style.transition = 'background-color 0.4s, left 0.6s ease-out, top 0.6s ease-out';
  };
  el.addEventListener('mousedown', evStart);
  window.addEventListener('mousemove', evMove);
  window.addEventListener('mouseup', evEnd);
}

function save() { localStorage.setItem(KEY, JSON.stringify(squad)); }
function resetApp() { localStorage.clear(); location.reload(); }
function saveField() {
  html2canvas(document.getElementById('field')).then(canvas => {
    const link = document.createElement('a');
    link.download = 'taktik-pro.png';
    link.href = canvas.toDataURL();
    link.click();
  });
}

// ƒ∞lk a√ßƒ±lƒ±≈üta bo≈ü kalmasƒ±n
if(localStorage.getItem(KEY)) {
  squad = JSON.parse(localStorage.getItem(KEY));
  renderList();
  drawTactics();
}
</script>
</body>
</html>
