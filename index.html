<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taktik Pro v35 - Tailwind Ultra</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <style>
        :root { --master-scale: 1; }
        body { background: #020617; color: #f8fafc; font-family: 'Inter', sans-serif; overflow-x: hidden; }
        
        #master-container { transform: scale(var(--master-scale)); transform-origin: top center; transition: transform 0.2s; }

        /* SAHA */
        .field { 
            width: 100%; height: 100%; min-width: 800px; min-height: 500px; 
            background: #166534; border: 4px solid #fff; position: relative;
            background-image: repeating-linear-gradient(90deg, transparent, transparent 95px, rgba(0,0,0,0.05) 95px, rgba(0,0,0,0.05) 190px);
            box-shadow: 0 25px 50px rgba(0,0,0,0.6);
        }
        .box { position: absolute; border: 3px solid #fff; }
        .box-l { left: 0; top: 25%; width: 15%; height: 50%; border-left: 0; }
        .box-r { right: 0; top: 25%; width: 15%; height: 50%; border-right: 0; }
        
        /* OYUNCU */
        .player {
            position: absolute; width: 80px; padding: 6px; border-radius: 12px;
            text-align: center; font-weight: 800; font-size: 10px;
            cursor: grab; z-index: 20; transform: translate(-50%, -50%);
            transition: left 0.4s ease, top 0.4s ease, transform 0.2s;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5);
        }
        .team-a { background: linear-gradient(135deg, #e11d48, #9f1239); border: 2px solid #fff; color: white; }
        .team-b { background: linear-gradient(135deg, #2563eb, #1e40af); border: 2px solid #fff; color: white; }
        .vest-on { background: #fbbf24 !important; color: #000 !important; border: 2px dashed #000 !important; transform: translate(-50%, -50%) scale(1.1); }

        /* DÄ°NAMÄ°K MENÃœLER */
        .ui-panel { 
            background: rgba(15, 23, 42, 0.9); border: 1px solid #334155; 
            backdrop-filter: blur(12px); overflow: hidden;
            resize: both; /* BOYUTLANDIRMA BURADA */
            min-width: 200px; min-height: 100px;
        }
        .edit-mode-active .ui-panel { border: 2px dashed #10b981 !important; box-shadow: 0 0 20px rgba(16, 185, 129, 0.2); }
        .panel-header { display: none; background: #10b981; color: #000; font-size: 10px; font-weight: 900; padding: 6px; cursor: move; text-transform: uppercase; }
        .edit-mode-active .panel-header { display: flex; justify-content: space-between; align-items: center; }
    </style>
</head>
<body class="selection:bg-emerald-500/30">

<nav class="fixed top-0 left-0 w-full z-[100] bg-slate-900/80 backdrop-blur-xl border-b border-slate-800 p-4 flex items-center justify-between shadow-2xl">
    <div class="flex items-center gap-8">
        <div class="text-2xl font-black italic tracking-tighter text-white">PRO<span class="text-emerald-500">BOARD</span></div>
        <div class="hidden md:flex items-center gap-4 bg-slate-950/50 px-5 py-2 rounded-2xl border border-slate-800">
            <span class="text-[10px] font-black text-slate-500 uppercase tracking-widest">Zoom</span>
            <input type="range" min="0.5" max="1.5" step="0.05" value="1" oninput="document.documentElement.style.setProperty('--master-scale', this.value)" class="w-32 h-1.5 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-emerald-500">
        </div>
    </div>
    
    <div class="flex items-center gap-3">
        <button onclick="resetLayout()" class="bg-slate-800 hover:bg-slate-700 text-slate-300 px-4 py-2.5 rounded-xl text-xs font-bold transition-all border border-slate-700">DÃ¼zeni SÄ±fÄ±rla</button>
        <button id="editToggle" onclick="toggleEditMode()" class="bg-emerald-500/10 hover:bg-emerald-500/20 text-emerald-500 px-4 py-2.5 rounded-xl text-xs font-black flex items-center gap-2 border border-emerald-500/20 transition-all">
            <span id="lockIcon">ðŸ”’</span> <span id="lockText">MOD: KÄ°LÄ°TLÄ°</span>
        </button>
        <button onclick="exportImage()" class="bg-emerald-600 hover:bg-emerald-500 text-white px-6 py-2.5 rounded-xl text-xs font-black shadow-lg shadow-emerald-900/20 transition-all">RESMÄ° AL</button>
    </div>
</nav>

<div id="master-container" class="pt-28">
    <div class="max-w-[1500px] mx-auto px-6 space-y-6">
        
        <div id="panelInputs" class="ui-panel rounded-3xl shadow-xl">
            <div class="panel-header"><span>â†• TAÅžIMA ALANI</span> <span class="text-[8px]">Ã–LÃ‡EKLENDÄ°R â†”</span></div>
            <div class="p-4 bg-slate-900/50 border-b border-slate-800 flex flex-wrap items-center gap-4">
                <select id="playerCount" onchange="updatePlayerList()" class="bg-slate-950 text-white px-4 py-2 rounded-xl text-xs font-bold border border-slate-700 focus:ring-2 focus:ring-emerald-500 outline-none"></select>
                <button onclick="distributeAndAlign()" class="bg-indigo-600 hover:bg-indigo-500 px-6 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest text-white transition-all shadow-lg shadow-indigo-900/40">KadrolarÄ± Kur</button>
                <button onclick="randomVest()" class="bg-amber-500 hover:bg-amber-400 px-6 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest text-black transition-all ml-auto shadow-lg shadow-amber-900/20">Yelek At</button>
            </div>
            <div id="playerInputs" class="p-6 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8 gap-4 overflow-y-auto max-h-[300px]"></div>
        </div>

        <div class="flex flex-col lg:flex-row gap-6">
            <div id="panelA" class="ui-panel w-full lg:w-72 rounded-3xl shrink-0 h-fit">
                <div class="panel-header">TAKIM A</div>
                <div class="p-6 space-y-8">
                    <div class="text-center"><span class="bg-rose-500/10 text-rose-500 px-4 py-1 rounded-full text-[10px] font-black tracking-[0.3em] uppercase">Team Alpha</span></div>
                    <div class="space-y-2">
                        <label class="text-[9px] font-black text-slate-500 uppercase">Strateji</label>
                        <select id="tacticA" onchange="realignOnly('a')" class="w-full bg-slate-950 p-3 rounded-xl text-xs font-bold border border-slate-800">
                            <option value="3-1-2">3-1-2 (Dengeli)</option><option value="2-2-2">2-2-2 (Ofansif)</option><option value="3-2-1">3-2-1 (Defansif)</option>
                        </select>
                    </div>
                    <div class="space-y-6">
                        <div class="group"><label class="text-[8px] font-bold text-slate-500 mb-2 block">DEFANS HATTI</label><input type="range" oninput="moveLine('a', 'DEF', this.value)" min="-120" max="120" value="0" class="w-full h-1.5 bg-slate-800 rounded-lg appearance-none accent-rose-500"></div>
                        <div class="group"><label class="text-[8px] font-bold text-slate-500 mb-2 block">ORTA SAHA</label><input type="range" oninput="moveLine('a', 'MID', this.value)" min="-120" max="120" value="0" class="w-full h-1.5 bg-slate-800 rounded-lg appearance-none accent-rose-500"></div>
                        <div class="group"><label class="text-[8px] font-bold text-slate-500 mb-2 block">FORVET</label><input type="range" oninput="moveLine('a', 'FWD', this.value)" min="-120" max="120" value="0" class="w-full h-1.5 bg-slate-800 rounded-lg appearance-none accent-rose-500"></div>
                    </div>
                </div>
            </div>

            <div id="panelField" class="ui-panel flex-1 rounded-3xl min-h-[600px] bg-slate-950/30 p-4">
                <div class="panel-header">SAHA MERKEZÄ°</div>
                <div id="field" class="field rounded-xl">
                    <div class="absolute left-1/2 top-0 w-0.5 h-full bg-white/30"></div>
                    <div class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-40 h-40 border-2 border-white/30 rounded-full"></div>
                    <div class="box box-l"></div><div class="box box-r"></div>
                    <div id="ball" class="absolute w-12 h-12 bg-white rounded-full flex items-center justify-center cursor-grab z-[100] text-2xl shadow-2xl border-4 border-slate-200" style="left:50%; top:50%; transform: translate(-50%, -50%)">âš½</div>
                </div>
            </div>

            <div id="panelB" class="ui-panel w-full lg:w-72 rounded-3xl shrink-0 h-fit">
                <div class="panel-header">TAKIM B</div>
                <div class="p-6 space-y-8">
                    <div class="text-center"><span class="bg-blue-500/10 text-blue-500 px-4 py-1 rounded-full text-[10px] font-black tracking-[0.3em] uppercase">Team Bravo</span></div>
                    <div class="space-y-2">
                        <label class="text-[9px] font-black text-slate-500 uppercase">Strateji</label>
                        <select id="tacticB" onchange="realignOnly('b')" class="w-full bg-slate-950 p-3 rounded-xl text-xs font-bold border border-slate-800">
                            <option value="3-1-2">3-1-2 (Dengeli)</option><option value="2-2-2">2-2-2 (Ofansif)</option><option value="3-2-1">3-2-1 (Defansif)</option>
                        </select>
                    </div>
                    <div class="space-y-6">
                        <div class="group"><label class="text-[8px] font-bold text-slate-500 mb-2 block">DEFANS HATTI</label><input type="range" oninput="moveLine('b', 'DEF', this.value)" min="-120" max="120" value="0" class="w-full h-1.5 bg-slate-800 rounded-lg appearance-none accent-blue-500"></div>
                        <div class="group"><label class="text-[8px] font-bold text-slate-500 mb-2 block">ORTA SAHA</label><input type="range" oninput="moveLine('b', 'MID', this.value)" min="-120" max="120" value="0" class="w-full h-1.5 bg-slate-800 rounded-lg appearance-none accent-blue-500"></div>
                        <div class="group"><label class="text-[8px] font-bold text-slate-500 mb-2 block">FORVET</label><input type="range" oninput="moveLine('b', 'FWD', this.value)" min="-120" max="120" value="0" class="w-full h-1.5 bg-slate-800 rounded-lg appearance-none accent-blue-500"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
let players = [];
let editMode = false;
let activeDrag = null, startX, startY, initialX, initialY, dragType = "";

const tacticData = {
    "3-1-2": { GK:[8,50], DEF:[[28,20],[28,50],[28,80]], MID:[[55,50]], FWD:[[82,30],[82,70]] },
    "2-2-2": { GK:[8,50], DEF:[[28,30],[28,70]], MID:[[55,30],[55,70]], FWD:[[82,30],[82,70]] },
    "3-2-1": { GK:[8,50], DEF:[[28,20],[28,50],[28,80]], MID:[[62,30],[62,70]], FWD:[[88,50]] }
};

function init() {
    const sel = document.getElementById('playerCount');
    for(let i=2; i<=22; i+=2) {
        let opt = document.createElement('option'); opt.value = i; opt.innerText = `${i} Oyuncu`;
        if(i===12) opt.selected = true; sel.appendChild(opt);
    }
    updatePlayerList();
    initPanelControls();
}

function toggleEditMode() {
    editMode = !editMode;
    document.body.classList.toggle('edit-mode-active', editMode);
    document.getElementById('lockIcon').innerText = editMode ? "ðŸ”“" : "ðŸ”’";
    document.getElementById('lockText').innerText = editMode ? "MOD: DÃœZENLEME" : "MOD: KÄ°LÄ°TLÄ°";
}

function resetLayout() {
    document.querySelectorAll('.ui-panel').forEach(p => {
        p.style.position = ""; p.style.left = ""; p.style.top = ""; p.style.width = ""; p.style.height = "";
    });
}

function initPanelControls() {
    document.querySelectorAll('.ui-panel').forEach(panel => {
        const header = panel.querySelector('.panel-header');
        header.onmousedown = (e) => {
            if(!editMode) return;
            activeDrag = panel; dragType = "panel";
            panel.style.position = "absolute";
            startX = e.clientX; startY = e.clientY;
            initialX = panel.offsetLeft; initialY = panel.offsetTop;
            panel.style.zIndex = 1000;
        };
    });
}

function updatePlayerList() {
    const count = parseInt(document.getElementById('playerCount').value);
    players = Array.from({length: count}, (_, i) => players[i] || { id: i, name: `OYUNCU ${i + 1}`, quality: 5, positions: ["MID"] });
    const container = document.getElementById('playerInputs');
    container.innerHTML = players.map((p, i) => `
        <div class="bg-slate-900/80 p-3 rounded-2xl border border-slate-800 space-y-3 shadow-inner hover:border-emerald-500/50 transition-all">
            <input type="text" value="${p.name}" oninput="players[${i}].name=this.value" class="w-full bg-slate-950 p-2 text-[10px] rounded-lg font-black border border-slate-800 outline-none text-emerald-500 uppercase">
            <div class="flex justify-between items-center px-1">
                <span class="text-[8px] font-black text-slate-500 uppercase tracking-tighter">Kalite</span>
                <select onchange="players[${i}].quality=parseInt(this.value)" class="bg-transparent text-[10px] text-white font-bold outline-none cursor-pointer">
                    ${[1,2,3,4,5,6,7,8,9,10].map(n => `<option value="${n}" ${p.quality===n?'selected':''}>${n}</option>`).join('')}
                </select>
            </div>
            <div class="grid grid-cols-2 gap-1">
                ${["GK","DEF","MID","FWD"].map(pos => `<button onclick="togglePos(${i},'${pos}',this)" class="text-[8px] py-1.5 rounded-lg font-black transition-all ${p.positions.includes(pos) ? 'bg-emerald-600 text-white shadow-lg shadow-emerald-900/40' : 'bg-slate-800 text-slate-500'}">${pos}</button>`).join('')}
            </div>
        </div>`).join('');
}

function togglePos(idx, pos, btn) {
    let p = players[idx];
    p.positions.includes(pos) ? p.positions = p.positions.filter(x => x !== pos) : p.positions.push(pos);
    updatePlayerList();
}

function distributeAndAlign() {
    const count = parseInt(document.getElementById('playerCount').value);
    let teamA = [], teamB = [];
    let pool = [...players].slice(0, count).sort((a,b) => b.quality - a.quality);
    pool.forEach((p, i) => (i % 2 === 0 ? teamA : teamB).push(p));
    document.querySelectorAll('.player:not(#ball)').forEach(e => e.remove());
    alignTeam(teamA, 'a', document.getElementById('tacticA').value);
    alignTeam(teamB, 'b', document.getElementById('tacticB').value);
}

function alignTeam(teamArr, teamName, tacKey) {
    const tac = tacticData[tacKey];
    let slots = [{role:'GK', pos:tac.GK}, ...tac.DEF.map(p=>({role:'DEF',pos:p})), ...tac.MID.map(p=>({role:'MID',pos:p})), ...tac.FWD.map(p=>({role:'FWD',pos:p}))];
    teamArr.forEach((p, i) => {
        if(!slots[i]) return;
        const el = document.createElement('div');
        el.className = `player team-${teamName}`;
        el.innerHTML = `<div class="truncate uppercase tracking-tighter">${p.name}</div><div class="text-[7px] opacity-60 font-black">${slots[i].role}</div>`;
        el.dataset.role = slots[i].role; el.dataset.team = teamName;
        let [rx, ry] = slots[i].pos;
        let fx = teamName === 'a' ? rx/2 : 100 - rx/2;
        el.style.left = fx + "%"; el.style.top = ry + "%"; el.dataset.baseX = fx;
        makeDraggable(el, "player");
        document.getElementById('field').appendChild(el);
    });
}

function makeDraggable(el, type) {
    el.onmousedown = (e) => {
        if(e.target.tagName === 'SELECT' || e.target.tagName === 'INPUT') return;
        e.stopPropagation();
        activeDrag = el; dragType = type;
        const scale = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--master-scale'));
        startX = e.clientX / scale; startY = e.clientY / scale;
        initialX = el.offsetLeft; initialY = el.offsetTop;
        el.style.transition = "none";
    };
}

window.onmousemove = (e) => {
    if(!activeDrag) return;
    const scale = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--master-scale'));
    if(dragType === "panel") {
        activeDrag.style.left = (initialX + (e.clientX - startX * scale)) + "px";
        activeDrag.style.top = (initialY + (e.clientY - startY * scale)) + "px";
    } else {
        activeDrag.style.left = (initialX + (e.clientX / scale - startX)) + "px";
        activeDrag.style.top = (initialY + (e.clientY / scale - startY)) + "px";
    }
};

window.onmouseup = () => {
    if(activeDrag && dragType === "player") activeDrag.style.transition = "left 0.4s ease, top 0.4s ease";
    activeDrag = null;
};

function moveLine(team, role, val) {
    document.querySelectorAll('.player').forEach(el => {
        if(el.dataset.team === team && el.dataset.role === role) {
            let base = parseFloat(el.dataset.baseX);
            el.style.left = `calc(${base}% + ${val}px)`;
        }
    });
}

function randomVest() {
    const team = Math.random() > 0.5 ? 'a' : 'b';
    document.querySelectorAll('.player').forEach(p => {
        p.classList.remove('vest-on');
        if(p.classList.contains(`team-${team}`)) p.classList.add('vest-on');
    });
}

function exportImage() {
    html2canvas(document.getElementById('field'), { scale: 3 }).then(canvas => {
        const link = document.createElement('a');
        link.download = 'taktik_board_pro.png'; link.href = canvas.toDataURL(); link.click();
    });
}

function realignOnly(t) { distributeAndAlign(); }
makeDraggable(document.getElementById('ball'), "player");
init();
</script>
</body>
</html>
