<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Taktik Pro – HALF FIELD STABLE</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<style>
body{background:#020617;color:white}

/* SAHA */
.field{
width:1100px;height:650px;margin:auto;position:relative;
background:radial-gradient(circle,#0a5c2a,#032b13);
border:5px solid #fff;border-radius:15px;
}

/* ÇİZGİLER */
.line{position:absolute;background:rgba(255,255,255,.8)}
.mid-line{left:50%;top:0;width:2px;height:100%}
.center-circle{
width:140px;height:140px;border:2px solid #fff;border-radius:50%;
left:50%;top:50%;position:absolute;transform:translate(-50%,-50%)
}
.goal{position:absolute;width:20px;height:120px;border:2px solid #fff;top:50%;transform:translateY(-50%)}
.goal.left{left:-20px}
.goal.right{right:-20px}

/* OYUNCU (KÜÇÜLTÜLDÜ) */
.player{
position:absolute;
width:90px;
padding:5px;
border-radius:10px;
transform:translate(-50%,-50%);
font-size:11px;
font-weight:bold;
text-align:center;
cursor:grab;
user-select:none;
}
.team-a{background:#f3a616;color:black}
.team-b{background:#43d1f0;color:black}
.vest{outline:3px dashed white}

/* TOP */
.ball{
position:absolute;width:36px;height:36px;border-radius:50%;
background:white;left:50%;top:50%;
transform:translate(-50%,-50%);
display:flex;align-items:center;justify-content:center
}
</style>
</head>

<body class="p-4">

<div class="flex gap-2 mb-3">
<select id="tA"><option>3-2-1</option><option>2-2-2</option></select>
<select id="tB"><option>3-2-1</option><option>2-2-2</option></select>

<button onclick="createTeams()">Takım</button>
<button onclick="applyTactics()">Diz</button>
<button onclick="randomVest()">Yelek</button>
</div>

<div id="canvas" class="field">
<div class="line mid-line"></div>
<div class="center-circle"></div>
<div class="goal left"></div>
<div class="goal right"></div>
<div id="ball" class="ball">⚽</div>
</div>

<script>
let players=[];
let active=null,sx,sy,ix,iy;

/* FORMASYONLAR – KALE ↔ ORTA SAHA */
const FORM={
"3-2-1":{
GK:[[8,50]],
DEF:[[20,30],[20,50],[20,70]],
MID:[[32,40],[32,60]],
FWD:[[44,50]]
},
"2-2-2":{
GK:[[8,50]],
DEF:[[20,35],[20,65]],
MID:[[32,30],[32,70]],
FWD:[[20,50],[44,50]]
}
};

function createTeams(){
players=[];
for(let i=0;i<14;i++){
players.push({
id:i,
name:"P"+(i+1),
team:i<7?"A":"B",
pos:["GK","DEF","MID","FWD"][i%4]
});
}
}

function applyTactics(){
document.querySelectorAll(".player").forEach(e=>e.remove());

["A","B"].forEach(team=>{
const form=FORM[team==="A"?tA.value:tB.value];
let used=0;

["GK","DEF","MID","FWD"].forEach(r=>{
form[r].forEach(p=>{
const pl=players.find(x=>x.team===team && x.pos===r && !x.used);
if(pl){
pl.used=true;
place(pl,p[0],p[1],team);
used++;
}
});
});

players.forEach(p=>p.used=false);
});
}

function place(p,x,y,team){
const d=document.createElement("div");
d.className="player team-"+team.toLowerCase();
d.textContent=p.name;

const halfX=team==="A"?x:x+50;
d.style.left=(halfX/100*1100)+"px";
d.style.top=(y/100*650)+"px";

d.onmousedown=e=>{
active=d;sx=e.clientX;sy=e.clientY;
ix=d.offsetLeft;iy=d.offsetTop;
};

d.ondblclick=()=>{
p.team=p.team==="A"?"B":"A";
d.classList.toggle("team-a");
d.classList.toggle("team-b");
d.style.left=(1100-d.offsetLeft)+"px";
};

canvas.appendChild(d);
}

window.onmousemove=e=>{
if(!active)return;
active.style.left=(ix+e.clientX-sx)+"px";
active.style.top=(iy+e.clientY-sy)+"px";
};
window.onmouseup=()=>active=null;

function randomVest(){
document.querySelectorAll(".player").forEach(p=>p.classList.remove("vest"));
const t=Math.random()<0.5?"a":"b";
document.querySelectorAll(".team-"+t).forEach(p=>p.classList.add("vest"));
}
</script>
</body>
</html>
