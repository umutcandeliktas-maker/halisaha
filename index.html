<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>HalÄ±saha TakÄ±m Kurucu</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#1e7f43" />
  <style>
    body { margin:0; font-family:Arial; background:#0f5132; color:#fff; }
    header { background:#1e7f43; padding:15px; text-align:center; font-size:20px; font-weight:bold; }
    .container { max-width:900px; margin:auto; padding:10px; }
    button { padding:10px 14px; margin:4px; border:none; border-radius:6px; background:#ffc107; font-weight:bold; cursor:pointer; }
    button.danger { background:#dc3545; color:#fff; }
    input, select { padding:6px; border-radius:4px; border:none; margin:2px; }
    .player { background:#198754; padding:8px; border-radius:6px; margin-bottom:6px; }
    .field { background:#198754; border-radius:10px; padding:10px; margin:15px 0; }
    .line { display:flex; justify-content:center; gap:8px; margin:10px 0; }
    .card { background:#fff; color:#000; padding:6px 8px; border-radius:6px; min-width:70px; text-align:center; font-size:13px; cursor:pointer; }
    .name { font-weight:bold; }
    .pos { font-size:12px; }
    @media(max-width:600px){ .card{min-width:60px;font-size:12px;} }
  </style>
</head>
<body>
<header>âš½ HalÄ±saha TakÄ±m Kurucu</header>
<div class="container">
<h3>Oyuncular (<span id="count">0</span>)</h3>
<button onclick="addPlayer()">â• Oyuncu Ekle</button>
<button class="danger" onclick="removePlayer()">â– Oyuncu Sil</button>
<div id="players"></div>
<hr>
<label><input type="radio" name="mode" value="one" checked> Tek takÄ±m</label>
<label style="margin-left:10px;"><input type="radio" name="mode" value="two"> Ä°ki takÄ±m</label>
<br><br>
<button onclick="createTeams()">ğŸŸï¸ TakÄ±m OluÅŸtur</button>
<button onclick="toggleVest()">ğŸ¦º Yelek DeÄŸiÅŸtir</button>
<button onclick="shareImage()">ğŸ“¸ Resim PaylaÅŸ</button>
<div style="margin:10px 0;">
  <label>TakÄ±m A Forma Rengi: <input type="color" id="colorA" value="#ffc107"></label>
  <label style="margin-left:10px;">TakÄ±m B Forma Rengi: <input type="color" id="colorB" value="#0dcaf0"></label>
</div>
<div id="teams"></div>
</div>
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script>
let players = JSON.parse(localStorage.getItem('players')) || [];
let vestTeam = 1;
let teamCaptains = {A:null,B:null};
if(players.length === 0){ players.push({name:'',pos:[],power:5}); save(); }
function save(){ localStorage.setItem('players', JSON.stringify(players)); }
function addPlayer(){ players.push({name:'',pos:[],power:5}); save(); renderPlayers(); }
function removePlayer(){ players.pop(); save(); renderPlayers(); }
function toggle(i,pos){ const p = players[i].pos; players[i].pos = p.includes(pos) ? p.filter(x=>x!==pos) : [...p,pos]; save(); }
function renderPlayers(){
  const div = document.getElementById('players'); div.innerHTML='';
  document.getElementById('count').innerText = players.length;
  players.forEach((p,i)=>{
    div.innerHTML += `<div class="player">
      <input placeholder="Ä°sim" value="${p.name}" onchange="players[${i}].name=this.value;save()">
      <label><input type="checkbox" ${p.pos.includes('GK')?'checked':''} onchange="toggle(${i},'GK')">GK</label>
      <label><input type="checkbox" ${p.pos.includes('DEF')?'checked':''} onchange="toggle(${i},'DEF')">DEF</label>
      <label><input type="checkbox" ${p.pos.includes('MID')?'checked':''} onchange="toggle(${i},'MID')">MID</label>
      <label><input type="checkbox" ${p.pos.includes('FWD')?'checked':''} onchange="toggle(${i},'FWD')">FWD</label>
      <select onchange="players[${i}].power=this.value;save()">
        ${Array.from({length:10},(_,k)=>k+1).map(n=>`<option ${p.power==n?'selected':''}>${n}</option>`).join('')}
      </select>
    </div>`;
  });
}
function shuffle(a){ return a.sort(()=>Math.random()-0.5); }
function createTeams(){
  const mode = document.querySelector('input[name="mode"]:checked').value;
  const gks = shuffle(players.filter(p=>p.pos.includes('GK')));
  const others = shuffle(players.filter(p=>!p.pos.includes('GK')));
  let t1=[], t2=[], p1=0, p2=0;
  if(mode==='two' && gks.length>=2){ t1.push(gks[0]); t2.push(gks[1]); p1+=Number(gks[0].power); p2+=Number(gks[1].power); }
  others.sort((a,b)=>b.power-a.power).forEach(p=>{ if(p1<=p2){ t1.push(p); p1+=Number(p.power); } else { t2.push(p); p2+=Number(p.power); } });
  if(mode==='one'){ document.getElementById('teams').innerHTML = teamHTML('Bizim TakÄ±m',shuffle(players),false,document.getElementById('colorA').value,'A'); return; }
  document.getElementById('teams').innerHTML = teamHTML('TakÄ±m A',t1,vestTeam===1,document.getElementById('colorA').value,'A') + teamHTML('TakÄ±m B',t2,vestTeam===2,document.getElementById('colorB').value,'B');
}
function setTeamCaptain(team,playerName){ teamCaptains[team]=playerName; createTeams(); }
function teamHTML(title,team,vest,color,teamId){
  let html=`<h3>${vest?'ğŸ¦º ':''}${title}`;
  html+=` <button onclick="setTeamCaptain('${teamId}', prompt('Kaptan ismini gir:'))">Kaptan SeÃ§</button>`;
  if(teamCaptains[teamId]) html+=` ğŸ§¢ ${teamCaptains[teamId]}`;
  html+=`</h3><div class="field" style="border:3px solid ${color}">`;
  const lines={GK:[],DEF:[],MID:[],FWD:[]}; team.forEach(p=>{ const pos = p.pos.includes('GK')?'GK':p.pos.includes('DEF')?'DEF':p.pos.includes('MID')?'MID':'FWD'; lines[pos].push(p); });
  ['GK','DEF','MID','FWD'].forEach(l=>{ if(lines[l].length){ html+='<div class="line">'; lines[l].forEach(p=>{ html+=`<div class="card" style="border:2px solid ${color}"><div class="name">${p.name}</div><div class="pos">${l} (${p.power})</div></div>`; }); html+='</div>'; } });
  html+='</div>'; return html;
}
function toggleVest(){ vestTeam=vestTeam===1?2:1; createTeams(); }
function shareImage(){ html2canvas(document.getElementById('teams')).then(canvas=>{ const link=document.createElement('a'); link.download='takimlar.png'; link.href=canvas.toDataURL(); link.click(); }); }
renderPlayers();
</script>
</body>
</html>
