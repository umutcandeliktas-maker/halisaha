<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>HalÄ±saha TakÄ±m Kurucu</title>
  <style>
    body { margin:0; font-family:Arial; background:#0f5132; color:#fff; }
    header { background:#1e7f43; padding:15px; text-align:center; font-size:20px; font-weight:bold; }
    .container { max-width:900px; margin:auto; padding:10px; }
    button { padding:10px 14px; margin:4px; border:none; border-radius:6px; background:#ffc107; font-weight:bold; cursor:pointer; }
    button.danger { background:#dc3545; color:#fff; }
    input, select { padding:6px; border-radius:4px; border:none; margin:2px; }
    .player { background:#198754; padding:8px; border-radius:6px; margin-bottom:6px; }
    .field { background:#198754; border-radius:10px; padding:10px; margin:15px 0; }
    .line { display:flex; justify-content:center; gap:8px; margin:10px 0; }
    .card { background:#fff; color:#000; padding:6px 8px; border-radius:6px; min-width:70px; text-align:center; font-size:13px; }
    .name { font-weight:bold; }
    .pos { font-size:12px; }
    @media(max-width:600px){ .card{min-width:60px;font-size:12px;} }
  </style>
</head>
<body>

<header>âš½ HalÄ±saha TakÄ±m Kurucu</header>

<div class="container">

<h3>Oyuncu Eklemek Ä°Ã§in Ä°htiyacÄ±nÄ±z Olan Tek Åey: Ä°simler!</h3>
<p>Oyuncu isimlerini tek tek girin ve hemen takÄ±mlarÄ±nÄ±zÄ± oluÅŸturun. Her oyuncu iÃ§in ismini girin, "Oyuncu Ekle" butonuna tÄ±klayÄ±n.</p>

<hr>

<!-- Tek Tek Oyuncu Ekleme -->
<div id="singlePlayerSection">
  <h4>Tek Tek Oyuncu Ekle</h4>
  <input type="text" id="singlePlayerName" placeholder="Oyuncu Ä°smini Girin">
  <button onclick="addSinglePlayer()">Oyuncu Ekle</button>
  <p>Her oyuncu iÃ§in ismini gir ve "Oyuncu Ekle" butonuna tÄ±kla.</p>
</div>

<hr>

<div id="players"></div>

<hr>

<label><input type="radio" name="mode" value="one" checked> Tek takÄ±m</label>
<label style="margin-left:10px;"><input type="radio" name="mode" value="two"> Ä°ki takÄ±m</label>

<br><br>
<button onclick="createTeams()">ğŸŸï¸ TakÄ±m OluÅŸtur</button>
<button onclick="toggleVest()">ğŸ¦º Yelek DeÄŸiÅŸtir</button>
<button onclick="shareImage()">ğŸ“¸ Resim PaylaÅŸ</button>
<button onclick="clearCache()">ğŸ§¹ Cache Temizle</button>

<div style="margin:10px 0;">
  <label>TakÄ±m A Forma Rengi: <input type="color" id="colorA" value="#ffc107"></label>
  <label style="margin-left:10px;">TakÄ±m B Forma Rengi: <input type="color" id="colorB" value="#0dcaf0"></label>
</div>

<div id="teams"></div>

</div>

<script>
// EÄŸer veriler varsa yÃ¼kle, yoksa baÅŸtan bir liste oluÅŸtur
let players = JSON.parse(localStorage.getItem('players')) || [];

// Veriyi kaydetmek iÃ§in
function save() {
  localStorage.setItem('players', JSON.stringify(players));
}

// OyuncularÄ± render et
function renderPlayers() {
  const div = document.getElementById('players');
  div.innerHTML = ''; // Ã–nceki oyuncularÄ± temizle
  players.forEach((p, i) => {
    div.innerHTML += `
      <div class="player">
        <input placeholder="Ä°sim" value="${p.name}" onchange="players[${i}].name=this.value;save()">
        <label><input type="checkbox" ${p.pos.includes('GK') ? 'checked' : ''} onchange="toggle(${i},'GK')">GK</label>
        <label><input type="checkbox" ${p.pos.includes('DEF') ? 'checked' : ''} onchange="toggle(${i},'DEF')">DEF</label>
        <label><input type="checkbox" ${p.pos.includes('MID') ? 'checked' : ''} onchange="toggle(${i},'MID')">MID</label>
        <label><input type="checkbox" ${p.pos.includes('FWD') ? 'checked' : ''} onchange="toggle(${i},'FWD')">FWD</label>
        <select onchange="players[${i}].power=this.value;save()">
          ${[1, 2, 3, 4, 5].map(n => `<option ${p.power == n ? 'selected' : ''}>${n}</option>`).join('')}
        </select>
        <button onclick="removePlayer(${i})">âŒ Sil</button>
      </div>
    `;
  });
}

// Tek tek oyuncu ekle
function addSinglePlayer() {
  let name = document.getElementById('singlePlayerName').value.trim();
  
  // EÄŸer isim boÅŸsa, otomatik bir isim ver
  if (name === "") {
    name = `Oyuncu ${players.length + 1}`;  // Ã–rneÄŸin "Oyuncu 1", "Oyuncu 2" ÅŸeklinde
  }
  
  // Yeni oyuncu ekle
  players.push({ name, pos: [], power: 3 });
  save();
  renderPlayers();
  
  // Input alanÄ±nÄ± temizle
  document.getElementById('singlePlayerName').value = '';
}

// Oyuncu sil
function removePlayer(i) {
  players.splice(i, 1);
  save();
  renderPlayers();
}

// Pozisyon seÃ§
function toggle(i, pos) {
  const p = players[i].pos;
  players[i].pos = p.includes(pos) ? p.filter(x => x !== pos) : [...p, pos];
  save();
}

// TakÄ±m oluÅŸtur
function createTeams() {
  const mode = document.querySelector('input[name="mode"]:checked').value;
  const list = [...players].sort((a, b) => b.power - a.power);

  if (mode === 'one') {
    document.getElementById('teams').innerHTML = teamHTML('Bizim TakÄ±m', list, false, document.getElementById('colorA').value);
    return;
  }

  let t1 = [], t2 = [], p1 = 0, p2 = 0;
  list.forEach(p => {
    if (p1 <= p2) { t1.push(p); p1 += Number(p.power); }
    else { t2.push(p); p2 += Number(p.power); }
  });

  document.getElementById('teams').innerHTML =
    teamHTML('TakÄ±m A', t1, vestTeam === 1, document.getElementById('colorA').value) +
    teamHTML('TakÄ±m B', t2, vestTeam === 2, document.getElementById('colorB').value);
}

// TakÄ±m dÃ¼zenlemesi
function teamHTML(title, team, vest, color) {
  const lines = { GK: [], DEF: [], MID: [], FWD: [] };
  team.forEach(p => {
    const pos = p.pos.includes('GK') ? 'GK' : p.pos.includes('DEF') ? 'DEF' : p.pos.includes('MID') ? 'MID' : 'FWD';
    lines[pos].push(p);
  });

  let html = `<h3>${vest ? 'ğŸ¦º ' : ''}${title}</h3><div class="field" style="border:3px solid ${color}">`;
  ['GK', 'DEF', 'MID', 'FWD'].forEach(l => {
    if (lines[l].length) {
      html += '<div class="line">';
      lines[l].forEach(p => {
        html += `<div class="card" style="border:2px solid ${color}"><div class="name">${p.name}</div><div class="pos">${l}</div></div>`;
      });
      html += '</div>';
    }
  });
  html += '</div>';
  return html;
}

// Cache temizle
function clearCache() {
  localStorage.removeItem('players');  // Sadece oyuncu verisini temizle
  players = []; // HafÄ±zayÄ± sÄ±fÄ±rlÄ±yoruz
  renderPlayers(); // Oyuncu listesini temizle
  alert('Veriler temizlendi!');
}

renderPlayers();
</script>

</body>
</html>
