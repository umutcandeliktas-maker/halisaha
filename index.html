<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HalÄ± Saha Taktik Pro</title>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* SAHA Ã–LÃ‡ÃœLERÄ° GENÄ°ÅLETÄ°LDÄ° */
    .field {
      position: relative;
      width: 100%;
      max-width: 950px; /* Daha geniÅŸ */
      height: 600px;    /* Daha yÃ¼ksek ve ferah */
      background-color: #15803d;
      border: 5px solid white;
      border-radius: 12px;
      margin: 20px auto;
      overflow: hidden;
      touch-action: none;
    }
    .line { position: absolute; background: white; }
    .center-line { top: 0; left: 50%; width: 2px; height: 100%; transform: translateX(-50%); }
    .center-circle { top: 50%; left: 50%; width: 110px; height: 110px; border: 2px solid white; border-radius: 50%; transform: translate(-50%, -50%); }
    .goal { position: absolute; width: 15px; height: 140px; border: 3px solid white; top: 50%; transform: translateY(-50%); background: rgba(255,255,255,0.1); }
    .penalty-area-a { position: absolute; left: 0; top: 50%; transform: translateY(-50%); width: 100px; height: 300px; border: 2px solid white; border-left: none; }
    .penalty-area-b { position: absolute; right: 0; top: 50%; transform: translateY(-50%); width: 100px; height: 300px; border: 2px solid white; border-right: none; }
    
    .player {
      position: absolute;
      padding: 8px 16px;
      border-radius: 50px;
      font-weight: bold;
      color: black;
      cursor: grab;
      user-select: none;
      box-shadow: 0 5px 10px rgba(0,0,0,0.4);
      z-index: 10;
      white-space: nowrap;
      border: 2px solid rgba(0,0,0,0.3);
      font-size: 14px;
    }
    .player:active { cursor: grabbing; transform: scale(1.1); z-index: 100; }
    
    .ball {
      position: absolute;
      width: 35px;
      height: 35px;
      background: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 50;
      box-shadow: 0 4px 10px rgba(0,0,0,0.6);
    }
  </style>
</head>
<body class="bg-slate-900 text-white font-sans">

<header class="bg-slate-800 text-center text-2xl font-black py-4 border-b-4 border-green-500">
  âš½ Ã–ZEL DÄ°ZÄ°LÄ°ÅLÄ° TAKTÄ°K TAHTASI
</header>

<div class="container mx-auto p-4">
  <div class="bg-slate-800 p-4 rounded-xl mb-6 flex flex-wrap gap-4 items-center justify-between shadow-lg">
    <div class="flex items-center gap-3">
      <label class="font-bold">Oyuncu SayÄ±sÄ±:</label>
      <select id="playerCount" class="bg-slate-700 p-2 rounded w-20 outline-none"></select>
      <button onclick="generatePlayers()" class="bg-green-600 hover:bg-green-500 px-6 py-2 rounded font-bold transition-all">LÄ°STEYÄ° YENÄ°LE</button>
    </div>
    <div class="flex gap-2">
      <button onclick="createTeams()" class="bg-yellow-500 text-slate-900 px-8 py-2 rounded-full font-black shadow-lg">ğŸŸï¸ SAHAYA DÄ°Z</button>
      <button onclick="shareImage()" class="bg-indigo-600 px-6 py-2 rounded-full font-bold">ğŸ“¸ RESMÄ° KAYDET</button>
    </div>
  </div>

  <div id="players" class="grid grid-cols-1 md:grid-cols-3 gap-3 mb-6"></div>

  <div class="flex justify-center gap-6 mb-4 bg-slate-800 p-3 rounded-lg w-fit mx-auto shadow-md">
    <label class="flex items-center gap-2"><input type="color" id="colorA" value="#fbbf24" class="h-8 w-8 rounded"> TakÄ±m A</label>
    <label class="flex items-center gap-2"><input type="color" id="colorB" value="#22d3ee" class="h-8 w-8 rounded"> TakÄ±m B</label>
  </div>

  <div id="teams"></div>
</div>

<script>
let players = [];
// GÃ–NDERDÄ°ÄÄ°N GÃ–RSELE GÃ–RE KOORDÄ°NATLAR (Kaleci -> Defanslar -> Orta Sahalar -> Forvet)
const tacticPositions = [
  { x: 50,  y: 280 }, // Kaleci
  { x: 180, y: 150 }, // Defans Ãœst
  { x: 180, y: 280 }, // Defans Orta
  { x: 180, y: 410 }, // Defans Alt
  { x: 350, y: 200 }, // Orta Saha Ãœst
  { x: 350, y: 360 }, // Orta Saha Alt
  { x: 450, y: 280 }  // Forvet
];

document.addEventListener('DOMContentLoaded', () => {
  const select = document.getElementById('playerCount');
  for (let i = 2; i <= 22; i++) {
    const opt = document.createElement('option');
    opt.value = i; opt.textContent = i;
    if(i === 14) opt.selected = true;
    select.appendChild(opt);
  }
  if (localStorage.getItem('players')) {
    players = JSON.parse(localStorage.getItem('players'));
    renderPlayers();
  }
});

function save() { localStorage.setItem('players', JSON.stringify(players)); }

function generatePlayers() {
  const count = Number(document.getElementById('playerCount').value);
  players = [];
  for (let i = 1; i <= count; i++) {
    players.push({ name: `Oyuncu ${i}` });
  }
  save();
  renderPlayers();
}

function renderPlayers() {
  const div = document.getElementById('players');
  div.innerHTML = '';
  players.forEach((p, i) => {
    const card = document.createElement('div');
    card.className = 'bg-slate-700 p-2 rounded flex items-center gap-2 border border-slate-600';
    card.innerHTML = `<input value="${p.name}" onchange="players[${i}].name=this.value;save()" class="bg-slate-800 text-white p-1 rounded w-full outline-none">`;
    div.appendChild(card);
  });
}

function createTeams() {
  if (players.length === 0) return;
  const teamA = [], teamB = [];
  players.forEach((p, idx) => {
    if (idx % 2 === 0) teamA.push(p);
    else teamB.push(p);
  });
  drawField(teamA, teamB);
}

function drawField(teamA, teamB) {
  const container = document.getElementById('teams');
  container.innerHTML = '';
  const field = document.createElement('div');
  field.className = 'field';
  field.id = "tacticalField";
  
  field.innerHTML = `
    <div class="center-line"></div>
    <div class="center-circle"></div>
    <div class="penalty-area-a"></div>
    <div class="penalty-area-b"></div>
    <div class="goal" style="left:-8px;"></div>
    <div class="goal" style="right:-8px;"></div>
  `;

  // Top (Tam Orta)
  const ball = document.createElement('div');
  ball.className = 'ball';
  ball.innerHTML = 'âš½';
  ball.style.top = '282px'; ball.style.left = '457px';
  makeDraggable(ball);
  field.appendChild(ball);

  const colorA = document.getElementById('colorA').value;
  const colorB = document.getElementById('colorB').value;

  // TakÄ±m A'yÄ± gÃ¶rseldeki yerlere diz
  teamA.forEach((p, i) => {
    if (i < tacticPositions.length) {
      const el = createPlayerEl(p, colorA);
      el.style.left = tacticPositions[i].x + 'px';
      el.style.top = tacticPositions[i].y + 'px';
      makeDraggable(el);
      field.appendChild(el);
    }
  });

  // TakÄ±m B'yi gÃ¶rselin simetriÄŸine diz
  teamB.forEach((p, i) => {
    if (i < tacticPositions.length) {
      const el = createPlayerEl(p, colorB);
      // X eksenini sahanÄ±n sonuna gÃ¶re aynalÄ±yoruz (950px - X)
      el.style.left = (910 - tacticPositions[i].x) + 'px';
      el.style.top = tacticPositions[i].y + 'px';
      makeDraggable(el);
      field.appendChild(el);
    }
  });

  container.appendChild(field);
}

function createPlayerEl(p, color) {
  const div = document.createElement('div');
  div.className = 'player';
  div.textContent = p.name;
  div.style.backgroundColor = color;
  return div;
}

function makeDraggable(el) {
  let isDragging = false;
  let startX, startY;

  const start = (e) => {
    isDragging = true;
    const cx = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
    const cy = e.type.includes('touch') ? e.touches[0].clientY : e.clientY;
    startX = cx - el.offsetLeft;
    startY = cy - el.offsetTop;
  };

  const move = (e) => {
    if (!isDragging) return;
    const cx = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
    const cy = e.type.includes('touch') ? e.touches[0].clientY : e.clientY;
    let nx = cx - startX;
    let ny = cy - startY;
    
    // Saha SÄ±nÄ±rlarÄ±
    const p = el.parentElement;
    nx = Math.max(0, Math.min(nx, p.clientWidth - el.offsetWidth));
    ny = Math.max(0, Math.min(ny, p.clientHeight - el.offsetHeight));
    
    el.style.left = nx + 'px';
    el.style.top = ny + 'px';
  };

  const end = () => isDragging = false;

  el.addEventListener('mousedown', start);
  window.addEventListener('mousemove', move);
  window.addEventListener('mouseup', end);
  el.addEventListener('touchstart', start);
  window.addEventListener('touchmove', move, { passive: false });
  window.addEventListener('touchend', end);
}

function shareImage() {
  const field = document.getElementById('tacticalField');
  html2canvas(field).then(canvas => {
    const a = document.createElement('a');
    a.href = canvas.toDataURL();
    a.download = 'ozel-dizilis.png';
    a.click();
  });
}
</script>
</body>
</html>
